<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Turni 4¬™ Squadra 2026</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0f172a">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #334155;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            background: linear-gradient(90deg, #60a5fa, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .oggi-info {
            background: linear-gradient(135deg, #1e40af, #7c3aed);
            border-radius: 16px;
            padding: 20px;
            margin: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(124, 58, 237, 0.3);
        }
        
        .oggi-turno {
            font-size: 48px;
            font-weight: 800;
            margin: 10px 0;
        }
        
        .oggi-orario {
            font-size: 20px;
            opacity: 0.9;
        }
        
        .countdown {
            margin-top: 15px;
            font-size: 16px;
            opacity: 0.8;
        }
        
        .prossimi {
            background: #1e293b;
            margin: 20px;
            border-radius: 16px;
            padding: 20px;
            border: 1px solid #334155;
        }
        
        .prossimi h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #94a3b8;
        }
        
        .prossimo-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 12px;
            background: #0f172a;
        }
        
        .prossimo-data {
            width: 60px;
            text-align: center;
            font-weight: 600;
        }
        
        .prossimo-giorno {
            font-size: 24px;
        }
        
        .prossimo-mese {
            font-size: 12px;
            opacity: 0.7;
        }
        
        .prossimo-turno {
            flex: 1;
            margin-left: 15px;
        }
        
        .prossimo-tipo {
            font-weight: 600;
            font-size: 16px;
        }
        
        .prossimo-orario {
            font-size: 14px;
            opacity: 0.7;
        }
        
        .badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-mat { background: #f59e0b; color: #000; }
        .badge-pom { background: #3b82f6; color: #fff; }
        .badge-not { background: #8b5cf6; color: #fff; }
        .badge-r { background: #10b981; color: #fff; }
        
        .calendario {
            margin: 20px;
        }
        
        .mese-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .mese-nome {
            font-size: 20px;
            font-weight: 700;
        }
        
        .nav-btn {
            background: #334155;
            border: none;
            color: #e2e8f0;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .nav-btn:hover { background: #475569; }
        .nav-btn:active { transform: scale(0.95); }
        
        .griglia {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }
        
        .giorno-header {
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            padding: 8px 0;
        }
        
        .giorno {
            aspect-ratio: 1;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            position: relative;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .giorno:hover { transform: scale(1.05); }
        .giorno:active { transform: scale(0.95); }
        
        .giorno-num {
            font-size: 16px;
            margin-bottom: 2px;
        }
        
        .giorno-turno {
            font-size: 10px;
            opacity: 0.9;
        }
        
        .giorno-mat { background: linear-gradient(135deg, #fbbf24, #f59e0b); color: #000; }
        .giorno-pom { background: linear-gradient(135deg, #60a5fa, #3b82f6); color: #fff; }
        .giorno-not { background: linear-gradient(135deg, #a78bfa, #8b5cf6); color: #fff; }
        .giorno-r { background: linear-gradient(135deg, #34d399, #10b981); color: #fff; }
        .giorno-vuoto { background: transparent; }
        
        .giorno-oggi {
            box-shadow: 0 0 0 3px #fff, 0 0 20px rgba(255,255,255,0.5);
        }
        
        .stats {
            background: #1e293b;
            margin: 20px;
            border-radius: 16px;
            padding: 20px;
            border: 1px solid #334155;
        }
        
        .stats h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #94a3b8;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .stat-card {
            background: #0f172a;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #64748b;
        }
        
        .export-section {
            margin: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #065f46, #047857);
            border-radius: 16px;
            text-align: center;
        }
        
        .export-section h3 {
            margin-bottom: 10px;
        }
        
        .export-section p {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        .export-btn {
            background: #fff;
            color: #065f46;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .export-btn:hover { transform: scale(1.05); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .export-btn:active { transform: scale(0.95); }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-content {
            background: #1e293b;
            border-radius: 20px;
            padding: 25px;
            max-width: 400px;
            width: 100%;
            text-align: center;
        }
        
        .modal h3 {
            font-size: 20px;
            margin-bottom: 15px;
        }
        
        .modal p {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .modal-btn {
            background: #3b82f6;
            color: #fff;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
        }
        
        .modal-btn-secondary {
            background: #475569;
        }
        
        .legenda {
            margin: 20px;
            padding: 15px;
            background: #1e293b;
            border-radius: 12px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .legenda-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
        }
        
        .legenda-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #64748b;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìÖ Turni 4¬™ Squadra 2026</h1>
        <div id="data-oggi"></div>
    </div>
    
    <div class="oggi-info" id="oggi-box">
        <!-- Populated by JS -->
    </div>
    
    <div class="prossimi">
        <h3>üìã Prossimi 7 giorni</h3>
        <div id="prossimi-lista"></div>
    </div>
    
    <div class="export-section">
        <h3>üì≤ Sincronizza col telefono</h3>
        <p>Scarica tutti i turni del 2026 e importali nel tuo calendario (iPhone, Android, Google Calendar)</p>
        <button class="export-btn" onclick="esportaICS()">
            <span>‚¨áÔ∏è</span> Scarica Calendario (.ics)
        </button>
    </div>
    
    <div class="calendario">
        <div class="mese-nav">
            <button class="nav-btn" onclick="cambiaMese(-1)">‚óÄ Prec</button>
            <div class="mese-nome" id="mese-nome"></div>
            <button class="nav-btn" onclick="cambiaMese(1)">Succ ‚ñ∂</button>
        </div>
        <div class="griglia" id="griglia-mese"></div>
    </div>
    
    <div class="legenda">
        <div class="legenda-item">
            <div class="legenda-color giorno-mat"></div>
            <span>Mattina 6-14</span>
        </div>
        <div class="legenda-item">
            <div class="legenda-color giorno-pom"></div>
            <span>Pomeriggio 14-22</span>
        </div>
        <div class="legenda-item">
            <div class="legenda-color giorno-not"></div>
            <span>Notte 22-6</span>
        </div>
        <div class="legenda-item">
            <div class="legenda-color giorno-r"></div>
            <span>Riposo</span>
        </div>
    </div>
    
    <div class="stats">
        <h3>üìä Statistiche 2026</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="stat-lavoro">0</div>
                <div class="stat-label">Giorni lavoro</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-riposo">0</div>
                <div class="stat-label">Giorni riposo</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-notti">0</div>
                <div class="stat-label">Turni notte</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="stat-ore">0</div>
                <div class="stat-label">Ore totali</div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        4¬™ Squadra ‚Ä¢ Aggiornato Nov 2025<br>
        Tocca un giorno per dettagli
    </div>
    
    <div id="modal-container"></div>

    <script>
        // Configurazione turni
        const CICLO = [
            { tipo: 'Not', nome: 'Notte', orario: '22:00 - 06:00', ore: 8 },
            { tipo: 'Not', nome: 'Notte', orario: '22:00 - 06:00', ore: 8 },
            { tipo: 'Not', nome: 'Notte', orario: '22:00 - 06:00', ore: 8 },
            { tipo: 'R', nome: 'Riposo', orario: 'Giorno libero', ore: 0 },
            { tipo: 'Pom', nome: 'Pomeriggio', orario: '14:00 - 22:00', ore: 8 },
            { tipo: 'Pom', nome: 'Pomeriggio', orario: '14:00 - 22:00', ore: 8 },
            { tipo: 'Pom', nome: 'Pomeriggio', orario: '14:00 - 22:00', ore: 8 },
            { tipo: 'R', nome: 'Riposo', orario: 'Giorno libero', ore: 0 },
            { tipo: 'Mat', nome: 'Mattina', orario: '06:00 - 14:00', ore: 8 },
            { tipo: 'Mat', nome: 'Mattina', orario: '06:00 - 14:00', ore: 8 },
            { tipo: 'Mat', nome: 'Mattina', orario: '06:00 - 14:00', ore: 8 },
            { tipo: 'R', nome: 'Riposo', orario: 'Giorno libero', ore: 0 },
        ];
        
        const MESI = ['Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 
                     'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre'];
        const GIORNI_SETT = ['Lun', 'Mar', 'Mer', 'Gio', 'Ven', 'Sab', 'Dom'];
        const GIORNI_MESE = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
        
        let meseCorrente = new Date().getMonth();
        
        // Calcola il turno per una data specifica
        function getTurno(anno, mese, giorno) {
            if (anno !== 2026) return null;
            
            // Calcola giorni dall'inizio dell'anno
            let giornoAnno = giorno;
            for (let i = 0; i < mese; i++) {
                giornoAnno += GIORNI_MESE[i];
            }
            
            // Il 1¬∞ gennaio 2026 √® il 2¬∞ giorno di Notte (indice 1)
            const indiceCiclo = (giornoAnno - 1 + 1) % 12;
            return CICLO[indiceCiclo];
        }
        
        // Formatta data
        function formatData(date) {
            const giorni = ['Domenica', 'Luned√¨', 'Marted√¨', 'Mercoled√¨', 'Gioved√¨', 'Venerd√¨', 'Sabato'];
            return `${giorni[date.getDay()]} ${date.getDate()} ${MESI[date.getMonth()]} ${date.getFullYear()}`;
        }
        
        // Aggiorna info oggi
        function aggiornaOggi() {
            const oggi = new Date();
            document.getElementById('data-oggi').textContent = formatData(oggi);
            
            // Per test usiamo 2026, in produzione usa oggi.getFullYear()
            const annoTest = 2026;
            const meseTest = oggi.getMonth();
            const giornoTest = oggi.getDate();
            
            const turno = getTurno(annoTest, meseTest, giornoTest);
            
            if (turno) {
                const oggiBox = document.getElementById('oggi-box');
                oggiBox.innerHTML = `
                    <div style="font-size: 14px; opacity: 0.8;">OGGI</div>
                    <div class="oggi-turno">${turno.nome}</div>
                    <div class="oggi-orario">${turno.orario}</div>
                    <div class="countdown" id="countdown"></div>
                `;
                
                // Countdown al prossimo turno
                aggiornaCountdown(turno);
            }
        }
        
        function aggiornaCountdown(turno) {
            const ora = new Date();
            let messaggio = '';
            
            if (turno.tipo === 'R') {
                messaggio = 'üòé Goditi il riposo!';
            } else if (turno.tipo === 'Mat') {
                const fine = new Date();
                fine.setHours(14, 0, 0, 0);
                if (ora < fine) {
                    const diff = fine - ora;
                    const ore = Math.floor(diff / 3600000);
                    const min = Math.floor((diff % 3600000) / 60000);
                    messaggio = `‚è∞ Fine turno tra ${ore}h ${min}m`;
                } else {
                    messaggio = '‚úÖ Turno completato!';
                }
            } else if (turno.tipo === 'Pom') {
                const fine = new Date();
                fine.setHours(22, 0, 0, 0);
                if (ora.getHours() < 14) {
                    const inizio = new Date();
                    inizio.setHours(14, 0, 0, 0);
                    const diff = inizio - ora;
                    const ore = Math.floor(diff / 3600000);
                    const min = Math.floor((diff % 3600000) / 60000);
                    messaggio = `üïê Inizio tra ${ore}h ${min}m`;
                } else if (ora < fine) {
                    const diff = fine - ora;
                    const ore = Math.floor(diff / 3600000);
                    const min = Math.floor((diff % 3600000) / 60000);
                    messaggio = `‚è∞ Fine turno tra ${ore}h ${min}m`;
                } else {
                    messaggio = '‚úÖ Turno completato!';
                }
            } else if (turno.tipo === 'Not') {
                messaggio = 'üåô Turno notturno';
            }
            
            document.getElementById('countdown').textContent = messaggio;
        }
        
        // Mostra prossimi giorni
        function mostraProssimi() {
            const lista = document.getElementById('prossimi-lista');
            lista.innerHTML = '';
            
            const oggi = new Date();
            
            for (let i = 0; i < 7; i++) {
                const data = new Date(2026, oggi.getMonth(), oggi.getDate() + i);
                const turno = getTurno(2026, data.getMonth(), data.getDate());
                
                if (turno) {
                    const item = document.createElement('div');
                    item.className = 'prossimo-item';
                    item.innerHTML = `
                        <div class="prossimo-data">
                            <div class="prossimo-giorno">${data.getDate()}</div>
                            <div class="prossimo-mese">${MESI[data.getMonth()].substring(0, 3)}</div>
                        </div>
                        <div class="prossimo-turno">
                            <div class="prossimo-tipo">${turno.nome}</div>
                            <div class="prossimo-orario">${turno.orario}</div>
                        </div>
                        <span class="badge badge-${turno.tipo.toLowerCase()}">${turno.tipo}</span>
                    `;
                    lista.appendChild(item);
                }
            }
        }
        
        // Renderizza mese
        function renderizzaMese() {
            const griglia = document.getElementById('griglia-mese');
            griglia.innerHTML = '';
            
            document.getElementById('mese-nome').textContent = `${MESI[meseCorrente]} 2026`;
            
            // Header giorni settimana
            GIORNI_SETT.forEach(g => {
                const div = document.createElement('div');
                div.className = 'giorno-header';
                div.textContent = g;
                griglia.appendChild(div);
            });
            
            // Primo giorno del mese (0 = Lun)
            const primoGiorno = new Date(2026, meseCorrente, 1).getDay();
            const offset = primoGiorno === 0 ? 6 : primoGiorno - 1;
            
            // Celle vuote
            for (let i = 0; i < offset; i++) {
                const div = document.createElement('div');
                div.className = 'giorno giorno-vuoto';
                griglia.appendChild(div);
            }
            
            // Giorni del mese
            const oggi = new Date();
            const isOggiMese = oggi.getMonth() === meseCorrente;
            
            for (let g = 1; g <= GIORNI_MESE[meseCorrente]; g++) {
                const turno = getTurno(2026, meseCorrente, g);
                const div = document.createElement('div');
                
                let classi = `giorno giorno-${turno.tipo.toLowerCase()}`;
                if (isOggiMese && g === oggi.getDate()) {
                    classi += ' giorno-oggi';
                }
                
                div.className = classi;
                div.innerHTML = `
                    <div class="giorno-num">${g}</div>
                    <div class="giorno-turno">${turno.tipo}</div>
                `;
                
                div.onclick = () => mostraDettaglio(g, turno);
                griglia.appendChild(div);
            }
        }
        
        function cambiaMese(delta) {
            meseCorrente += delta;
            if (meseCorrente < 0) meseCorrente = 11;
            if (meseCorrente > 11) meseCorrente = 0;
            renderizzaMese();
        }
        
        function mostraDettaglio(giorno, turno) {
            const data = new Date(2026, meseCorrente, giorno);
            const nomeGiorno = ['Domenica', 'Luned√¨', 'Marted√¨', 'Mercoled√¨', 'Gioved√¨', 'Venerd√¨', 'Sabato'][data.getDay()];
            
            const modal = document.getElementById('modal-container');
            modal.innerHTML = `
                <div class="modal" onclick="chiudiModal(event)">
                    <div class="modal-content" onclick="event.stopPropagation()">
                        <h3>${nomeGiorno} ${giorno} ${MESI[meseCorrente]}</h3>
                        <p>
                            <strong style="font-size: 24px;">${turno.nome}</strong><br><br>
                            üïê ${turno.orario}<br>
                            ‚è±Ô∏è ${turno.ore} ore di lavoro
                        </p>
                        <button class="modal-btn" onclick="chiudiModal()">Chiudi</button>
                    </div>
                </div>
            `;
        }
        
        function chiudiModal(e) {
            if (!e || e.target.classList.contains('modal')) {
                document.getElementById('modal-container').innerHTML = '';
            }
        }
        
        // Calcola statistiche
        function calcolaStats() {
            let lavoro = 0, riposo = 0, notti = 0, ore = 0;
            
            for (let m = 0; m < 12; m++) {
                for (let g = 1; g <= GIORNI_MESE[m]; g++) {
                    const turno = getTurno(2026, m, g);
                    if (turno.tipo === 'R') {
                        riposo++;
                    } else {
                        lavoro++;
                        ore += turno.ore;
                        if (turno.tipo === 'Not') notti++;
                    }
                }
            }
            
            document.getElementById('stat-lavoro').textContent = lavoro;
            document.getElementById('stat-riposo').textContent = riposo;
            document.getElementById('stat-notti').textContent = notti;
            document.getElementById('stat-ore').textContent = ore.toLocaleString();
        }
        
        // EXPORT ICS - Funzionalit√† principale!
        function esportaICS() {
            let ics = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//4a Squadra//Turni 2026//IT
CALSCALE:GREGORIAN
METHOD:PUBLISH
X-WR-CALNAME:Turni 4¬™ Squadra 2026
X-WR-TIMEZONE:Europe/Rome
`;
            
            // Genera eventi per tutto l'anno
            for (let m = 0; m < 12; m++) {
                for (let g = 1; g <= GIORNI_MESE[m]; g++) {
                    const turno = getTurno(2026, m, g);
                    
                    // Formatta data per ICS
                    const meseStr = String(m + 1).padStart(2, '0');
                    const giornoStr = String(g).padStart(2, '0');
                    const dataStr = `2026${meseStr}${giornoStr}`;
                    
                    let inizio, fine, sommario;
                    
                    if (turno.tipo === 'Mat') {
                        inizio = `${dataStr}T060000`;
                        fine = `${dataStr}T140000`;
                        sommario = 'üåÖ MATTINA 6-14';
                    } else if (turno.tipo === 'Pom') {
                        inizio = `${dataStr}T140000`;
                        fine = `${dataStr}T220000`;
                        sommario = '‚òÄÔ∏è POMERIGGIO 14-22';
                    } else if (turno.tipo === 'Not') {
                        inizio = `${dataStr}T220000`;
                        // La notte finisce il giorno dopo
                        const domani = new Date(2026, m, g + 1);
                        const domaniStr = `${domani.getFullYear()}${String(domani.getMonth() + 1).padStart(2, '0')}${String(domani.getDate()).padStart(2, '0')}`;
                        fine = `${domaniStr}T060000`;
                        sommario = 'üåô NOTTE 22-6';
                    } else {
                        // Riposo - evento tutto il giorno
                        inizio = dataStr;
                        fine = dataStr;
                        sommario = 'üòé RIPOSO';
                    }
                    
                    const uid = `turno-${dataStr}@4squadra`;
                    
                    if (turno.tipo === 'R') {
                        ics += `BEGIN:VEVENT
UID:${uid}
DTSTART;VALUE=DATE:${inizio}
DTEND;VALUE=DATE:${fine}
SUMMARY:${sommario}
DESCRIPTION:Giorno di riposo
END:VEVENT
`;
                    } else {
                        ics += `BEGIN:VEVENT
UID:${uid}
DTSTART:${inizio}
DTEND:${fine}
SUMMARY:${sommario}
DESCRIPTION:Turno ${turno.nome} - ${turno.orario}
BEGIN:VALARM
TRIGGER:-PT1H
ACTION:DISPLAY
DESCRIPTION:Turno tra 1 ora
END:VALARM
BEGIN:VALARM
TRIGGER:-PT15M
ACTION:DISPLAY
DESCRIPTION:Turno tra 15 minuti
END:VALARM
END:VEVENT
`;
                    }
                }
            }
            
            ics += 'END:VCALENDAR';
            
            // Download del file
            const blob = new Blob([ics], { type: 'text/calendar;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Turni_4Squadra_2026.ics';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Mostra istruzioni
            const modal = document.getElementById('modal-container');
            modal.innerHTML = `
                <div class="modal" onclick="chiudiModal(event)">
                    <div class="modal-content" onclick="event.stopPropagation()">
                        <h3>‚úÖ File Scaricato!</h3>
                        <p>
                            <strong>iPhone/iPad:</strong><br>
                            Apri il file ‚Üí "Aggiungi tutti gli eventi"<br><br>
                            <strong>Android:</strong><br>
                            Apri con Google Calendar ‚Üí Importa<br><br>
                            <strong>Computer:</strong><br>
                            Doppio click sul file .ics<br><br>
                            üì± Riceverai notifiche automatiche 1 ora e 15 minuti prima di ogni turno!
                        </p>
                        <button class="modal-btn" onclick="chiudiModal()">Perfetto!</button>
                    </div>
                </div>
            `;
        }
        
        // Inizializzazione
        aggiornaOggi();
        mostraProssimi();
        renderizzaMese();
        calcolaStats();
        
        // Aggiorna countdown ogni minuto
        setInterval(() => {
            const turno = getTurno(2026, new Date().getMonth(), new Date().getDate());
            if (turno) aggiornaCountdown(turno);
        }, 60000);
    </script>
</body>
</html>
